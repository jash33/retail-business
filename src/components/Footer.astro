---
/**
 * Footer Component
 * Global footer displaying contact information, service areas,
 * social media links, and copyright information.
 *
 * @example
 * ```astro
 * <Footer
 *   phone="(555) 123-4567"
 *   email="info@example.com"
 *   socialLinks={[
 *     { platform: 'facebook', url: 'https://facebook.com/example' }
 *   ]}
 * />
 * ```
 */

import { seoConfig } from '../config/seo.config';

// Define the social platform types
type SocialPlatform = 'facebook' | 'twitter' | 'instagram' | 'linkedin' | 'youtube';

interface SocialLink {
  /** The social media platform */
  platform: SocialPlatform;
  /** URL to the social media profile */
  url: string;
}

interface Props {
  /** Phone number (displayed and used for tel: link) */
  phone?: string;
  /** Email address (displayed and used for mailto: link) */
  email?: string;
  /** Company name for copyright */
  companyName?: string;
  /** Social media links (optional) */
  socialLinks?: SocialLink[];
  /** Service areas to display */
  serviceAreas?: string[];
}

// Default service areas based on the seo.config.ts
const defaultServiceAreas = [
  'Houston',
  'Greater Houston Area',
];

const {
  phone = seoConfig.organization?.contactPoint?.telephone,
  email = seoConfig.organization?.contactPoint?.email,
  companyName = seoConfig.siteName,
  socialLinks = [],
  serviceAreas = defaultServiceAreas,
} = Astro.props;

// Get the current year dynamically
const currentYear = new Date().getFullYear();

// SVG icons for social platforms
const socialIcons: Record<SocialPlatform, string> = {
  facebook: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" aria-hidden="true"><path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/></svg>`,
  twitter: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>`,
  instagram: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" aria-hidden="true"><path d="M12 2c2.717 0 3.056.01 4.122.06 1.065.05 1.79.217 2.428.465.66.254 1.216.598 1.772 1.153.509.5.902 1.105 1.153 1.772.247.637.415 1.363.465 2.428.047 1.066.06 1.405.06 4.122 0 2.717-.01 3.056-.06 4.122-.05 1.065-.218 1.79-.465 2.428a4.883 4.883 0 01-1.153 1.772c-.5.508-1.105.902-1.772 1.153-.637.247-1.363.415-2.428.465-1.066.047-1.405.06-4.122.06-2.717 0-3.056-.01-4.122-.06-1.065-.05-1.79-.218-2.428-.465a4.89 4.89 0 01-1.772-1.153 4.904 4.904 0 01-1.153-1.772c-.248-.637-.415-1.363-.465-2.428C2.013 15.056 2 14.717 2 12c0-2.717.01-3.056.06-4.122.05-1.066.217-1.79.465-2.428a4.88 4.88 0 011.153-1.772A4.897 4.897 0 015.45 2.525c.638-.248 1.362-.415 2.428-.465C8.944 2.013 9.283 2 12 2zm0 1.802c-2.67 0-2.986.01-4.04.058-.976.045-1.505.207-1.858.344-.466.182-.8.398-1.15.748-.35.35-.566.684-.748 1.15-.137.353-.3.882-.344 1.857-.048 1.055-.058 1.37-.058 4.041 0 2.67.01 2.986.058 4.04.045.976.207 1.505.344 1.858.182.466.399.8.748 1.15.35.35.684.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058 2.67 0 2.987-.01 4.04-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.684.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041 0-2.67-.01-2.986-.058-4.04-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.055-.048-1.37-.058-4.041-.058zm0 3.063a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 8.468a3.333 3.333 0 100-6.666 3.333 3.333 0 000 6.666zm6.538-8.671a1.2 1.2 0 11-2.4 0 1.2 1.2 0 012.4 0z"/></svg>`,
  linkedin: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" aria-hidden="true"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>`,
  youtube: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" aria-hidden="true"><path d="M23.498 6.186a3.016 3.016 0 00-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 00.502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 002.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 002.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>`,
};

// Helper to get platform display name for accessibility
const platformNames: Record<SocialPlatform, string> = {
  facebook: 'Facebook',
  twitter: 'X (Twitter)',
  instagram: 'Instagram',
  linkedin: 'LinkedIn',
  youtube: 'YouTube',
};
---

<footer id="footer" class="footer" role="contentinfo">
  <!-- Decorative gradient accent line at top of footer -->
  <div class="footer__accent-line" aria-hidden="true"></div>

  <div class="footer__container">
    <div class="footer__content">
      <!-- Contact Information Section -->
      <section class="footer__section footer__contact" aria-labelledby="footer-contact-heading">
        <h2 id="footer-contact-heading" class="footer__heading">Contact Us</h2>
        <address class="footer__address">
          {phone && (
            <p class="footer__contact-item">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="footer__icon" aria-hidden="true">
                <path fill-rule="evenodd" d="M1.5 4.5a3 3 0 013-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 01-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 006.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 011.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 01-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5z" clip-rule="evenodd" />
              </svg>
              <a href={`tel:${phone.replace(/\D/g, '')}`} class="footer__link" aria-label={`Call us at ${phone}`}>
                {phone}
              </a>
            </p>
          )}
          {email && (
            <p class="footer__contact-item">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="footer__icon" aria-hidden="true">
                <path d="M1.5 8.67v8.58a3 3 0 003 3h15a3 3 0 003-3V8.67l-8.928 5.493a3 3 0 01-3.144 0L1.5 8.67z" />
                <path d="M22.5 6.908V6.75a3 3 0 00-3-3h-15a3 3 0 00-3 3v.158l9.714 5.978a1.5 1.5 0 001.572 0L22.5 6.908z" />
              </svg>
              <a href={`mailto:${email}`} class="footer__link" aria-label={`Email us at ${email}`}>
                {email}
              </a>
            </p>
          )}
          {!phone && !email && (
            <p class="footer__contact-item footer__contact-item--placeholder">
              Contact information coming soon
            </p>
          )}
        </address>
      </section>

      <!-- Service Areas Section -->
      <section class="footer__section footer__service-areas" aria-labelledby="footer-areas-heading">
        <h2 id="footer-areas-heading" class="footer__heading">Service Areas</h2>
        <ul class="footer__areas-list" role="list">
          {serviceAreas.map((area) => (
            <li class="footer__area-item">{area}</li>
          ))}
        </ul>
      </section>

      <!-- Social Media Section (conditionally rendered) -->
      {socialLinks && socialLinks.length > 0 && (
        <section class="footer__section footer__social" aria-labelledby="footer-social-heading">
          <h2 id="footer-social-heading" class="footer__heading">Follow Us</h2>
          <nav class="footer__social-nav" aria-label="Social media links">
            <ul class="footer__social-list" role="list">
              {socialLinks.map((link) => (
                <li class="footer__social-item">
                  <a
                    href={link.url}
                    class="footer__social-link"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label={`Follow us on ${platformNames[link.platform]} (opens in new tab)`}
                  >
                    <Fragment set:html={socialIcons[link.platform]} />
                  </a>
                </li>
              ))}
            </ul>
          </nav>
        </section>
      )}
    </div>

    <!-- Bottom Bar with Copyright -->
    <div class="footer__bottom">
      <p class="footer__copyright">
        &copy; {currentYear} {companyName}. All rights reserved.
      </p>
    </div>
  </div>
</footer>

<style>
  /* =================================================================
   * FOOTER COMPONENT STYLES
   * =================================================================
   * Uses design system variables from variables.css
   * Follows BEM naming convention for maintainability
   */

  .footer {
    position: relative;
    background-color: var(--color-primary-900);
    color: var(--color-text-inverse);
    padding: var(--spacing-12) var(--spacing-4);
    padding-top: calc(var(--spacing-12) + 4px); /* Account for accent line */
    margin-top: auto; /* Pushes footer to bottom when using flexbox on parent */
  }

  /* -----------------------------------------------------------------
   * Decorative Gradient Accent Line
   * Animated gradient line at the top of the footer
   * ----------------------------------------------------------------- */
  .footer__accent-line {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(
      90deg,
      var(--color-primary-700) 0%,
      var(--color-accent) 25%,
      var(--color-accent-alt) 50%,
      var(--color-accent) 75%,
      var(--color-primary-700) 100%
    );
    background-size: 200% 100%;
    animation: footer-accent-shimmer 8s ease-in-out infinite;
  }

  @keyframes footer-accent-shimmer {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  .footer__container {
    max-width: var(--container-7xl);
    margin: 0 auto;
  }

  .footer__content {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--spacing-8);
  }

  /* Footer Sections */
  .footer__section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-4);
  }

  .footer__heading {
    font-family: var(--font-heading);
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-inverse);
    margin: 0 0 var(--spacing-2);
    letter-spacing: var(--letter-spacing-wide);
    position: relative;
    display: inline-block;
  }

  /* Subtle gradient underline for headings */
  .footer__heading::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 2rem;
    height: 2px;
    background: linear-gradient(
      90deg,
      var(--color-accent) 0%,
      var(--color-accent-alt) 100%
    );
    border-radius: var(--radius-full);
    opacity: 0.7;
  }

  /* Contact Section */
  .footer__address {
    font-style: normal;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
  }

  .footer__contact-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    color: var(--color-primary-100);
    font-size: var(--font-size-base);
    margin: 0;
  }

  .footer__contact-item--placeholder {
    color: var(--color-primary-200);
    font-style: italic;
  }

  .footer__icon {
    width: var(--spacing-5);
    height: var(--spacing-5);
    flex-shrink: 0;
    color: var(--color-primary-300);
  }

  .footer__link {
    color: var(--color-primary-100);
    text-decoration: none;
    position: relative;
    transition:
      color var(--animation-duration-fast) var(--ease-smooth);
  }

  /* Animated underline for links */
  .footer__link::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(
      90deg,
      var(--color-accent) 0%,
      var(--color-accent-alt) 100%
    );
    transform: scaleX(0);
    transform-origin: left center;
    transition: transform var(--animation-duration-fast) var(--ease-spring-soft);
  }

  .footer__link:hover {
    color: var(--color-text-inverse);
  }

  .footer__link:hover::after {
    transform: scaleX(1);
  }

  .footer__link:focus-visible {
    outline: var(--focus-ring-width) solid var(--color-primary-300);
    outline-offset: var(--focus-ring-offset);
    border-radius: var(--radius-sm);
  }

  /* Service Areas Section */
  .footer__areas-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-2);
  }

  .footer__area-item {
    color: var(--color-primary-100);
    font-size: var(--font-size-base);
    padding-left: var(--spacing-4);
    position: relative;
  }

  .footer__area-item::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 6px;
    height: 6px;
    background-color: var(--color-primary-400);
    border-radius: var(--radius-full);
  }

  /* Social Media Section */
  .footer__social-nav {
    display: block;
  }

  .footer__social-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    gap: var(--spacing-4);
    flex-wrap: wrap;
  }

  .footer__social-item {
    display: flex;
  }

  .footer__social-link {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--spacing-10);
    height: var(--spacing-10);
    background-color: var(--color-primary-700);
    border-radius: var(--radius-lg);
    color: var(--color-primary-100);
    position: relative;
    overflow: hidden;
    transition:
      background-color var(--animation-duration-fast) var(--ease-smooth),
      color var(--animation-duration-fast) var(--ease-smooth),
      transform var(--animation-duration-fast) var(--ease-spring-soft),
      box-shadow var(--animation-duration-normal) var(--ease-smooth);
  }

  /* Gradient overlay on hover */
  .footer__social-link::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      135deg,
      var(--color-accent) 0%,
      var(--color-accent-alt) 100%
    );
    opacity: 0;
    transition: opacity var(--animation-duration-normal) var(--ease-smooth);
    z-index: 0;
  }

  /* Shine sweep effect */
  .footer__social-link::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(255, 255, 255, 0.2) 50%,
      transparent 100%
    );
    transition: left var(--animation-duration-slow) var(--ease-smooth);
    z-index: 2;
  }

  .footer__social-link:hover {
    background-color: var(--color-primary-600);
    color: var(--color-text-inverse);
    transform: translateY(-3px) scale(1.05);
    box-shadow: var(--glow-accent-md);
  }

  .footer__social-link:hover::before {
    opacity: 0.9;
  }

  .footer__social-link:hover::after {
    left: 100%;
  }

  .footer__social-link:active {
    transform: translateY(-1px) scale(1.02);
    transition-duration: var(--animation-duration-instant);
  }

  .footer__social-link:focus-visible {
    outline: var(--focus-ring-width) solid var(--color-primary-300);
    outline-offset: var(--focus-ring-offset);
    box-shadow: var(--glow-accent-sm);
  }

  .footer__social-link :global(svg) {
    width: var(--spacing-5);
    height: var(--spacing-5);
    position: relative;
    z-index: 1;
    transition: transform var(--animation-duration-fast) var(--ease-spring-soft);
  }

  .footer__social-link:hover :global(svg) {
    transform: scale(1.1);
  }

  /* Bottom Bar */
  .footer__bottom {
    margin-top: var(--spacing-8);
    padding-top: var(--spacing-6);
    border-top: 1px solid var(--color-primary-700);
  }

  .footer__copyright {
    font-size: var(--font-size-sm);
    color: var(--color-primary-200);
    text-align: center;
    margin: 0;
  }

  /* =================================================================
   * RESPONSIVE STYLES
   * =================================================================
   */

  /* Tablet and up (768px) */
  @media screen and (min-width: 768px) {
    .footer {
      padding: var(--spacing-16) var(--spacing-8);
      padding-top: calc(var(--spacing-16) + 4px);
    }

    .footer__content {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-12);
    }

    .footer__bottom {
      margin-top: var(--spacing-12);
    }
  }

  /* Desktop (1024px) */
  @media screen and (min-width: 1024px) {
    .footer__content {
      grid-template-columns: repeat(3, 1fr);
    }

    .footer__areas-list {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--spacing-2) var(--spacing-6);
    }
  }

  /* Large Desktop (1280px) */
  @media screen and (min-width: 1280px) {
    .footer {
      padding: var(--spacing-20) var(--spacing-8);
      padding-top: calc(var(--spacing-20) + 4px);
    }
  }

  /* =================================================================
   * PRINT STYLES
   * =================================================================
   */

  @media print {
    .footer {
      background-color: transparent;
      color: var(--color-text-primary);
      border-top: 1px solid var(--color-border);
      padding: var(--spacing-8) 0;
    }

    .footer__accent-line {
      display: none;
    }

    .footer__heading::after {
      display: none;
    }

    .footer__link,
    .footer__contact-item,
    .footer__area-item,
    .footer__copyright {
      color: var(--color-text-primary);
    }

    .footer__social {
      display: none;
    }

    .footer__bottom {
      border-top-color: var(--color-border);
    }
  }

  /* =================================================================
   * REDUCED MOTION PREFERENCES
   * =================================================================
   * Disable animations for users who prefer reduced motion
   */

  @media (prefers-reduced-motion: reduce) {
    .footer__accent-line {
      animation: none;
    }

    .footer__social-link {
      transition: none;
    }

    .footer__social-link::before,
    .footer__social-link::after {
      transition: none;
    }

    .footer__social-link::after {
      display: none;
    }

    .footer__social-link:hover {
      transform: none;
    }

    .footer__social-link:active {
      transform: none;
    }

    .footer__social-link :global(svg) {
      transition: none;
    }

    .footer__social-link:hover :global(svg) {
      transform: none;
    }

    .footer__link {
      transition: none;
    }

    .footer__link::after {
      transition: none;
    }
  }
</style>
